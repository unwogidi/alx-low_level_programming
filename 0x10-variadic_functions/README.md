How to implement variadic function and va_start, va_arg and va_end macros